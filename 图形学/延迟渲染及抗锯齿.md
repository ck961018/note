# 延迟渲染

> &emsp;&emsp;延迟渲染首先进行几何处理Pass，通过多目标渲染（Multiple Render Targets，MRT）技术，获取对象的几何信息保存到G-buffer中，包括位置向量、法线向量及颜色和镜面值，PBR的话还有金属度和粗糙度。然后根据G-buffer中的数据对每个像素进行片段处理，每个像素只进行一次光照计算。基本思想是先进行深度测试再进行着色计算，将物体空间的光照计算放到屏幕空间上了。
> &emsp;&emsp;优点：复杂度O（v.m*n）（games202），节省计算量；
> &emsp;&emsp;缺点：显存开销大、不支持混色、对MSAA不友好。
> &emsp;&emsp;与Early-Z及Z-Prepass的区别：延迟渲染只会对每个像素进行单次着色计算，而其它两者依旧会根据光源数量进行多次着色。

# 抗锯齿
## 1.SSAA
> &emsp;&emsp;在多倍分辨率下进行渲染，然后下采样至当前分辨率。这是数学上最优的抗锯齿方法，但缺点也显而易见，计算负荷是原来的多倍。
## 2.MSAA
> &emsp;&emsp;MSAA是SSAA基础上提出的，与SSAA不同的是，MSAA仅在光栅化阶段进行多倍的采样，但在着色阶段只对像素中心点进行着色计算，最后结果乘上一个覆盖率。
> &emsp;&emsp;MSAA对延迟渲染支持不是很好，因为延迟渲染需要把信息全部放在G-buffer上，单倍G-buffer无法获取子采样被三角形覆盖的信息，多倍G-buffer也无法获取通过插值获取像素中心的各种数据。同时，低版本的DX中MRT不支持MSAA。
## 3.FXAA
> &emsp;&emsp;FXAA是MSAA的一种高性能近似，在后处理阶段实现。主要思想就是找出图像的边缘，然后进行平滑操作。
## 4.TAA
> &emsp;&emsp;锯齿分为几何锯齿和着色锯齿，FXAA是一种空域抗锯齿技术，只能缓解几何锯齿。TAA是一种时域抗锯齿技术，它将SSAA和MSAA中的超采样计算分摊到邻近的不同帧中，并通过抖动来进行采样。如果模型有运动，会将运动矢量（Motion Vector）保存至缓存中，在采样时进行重投影，获取历史帧上的像素位置。为了解决重影问题，会进行历史帧像素修正，检测当前帧像素和历史帧像素的差异，差异过大时，将历史帧截断（clamp）在合理范围内。最后将历史帧像素和当前帧像素进行混合。
## 4.TAA
> &emsp;&emsp;深度学习超采样。